(l=>{var r,i,o;function a(e,t){var n;if(!(this instanceof a))return(n=new a(e,t)).open(),n;this.id=a.id++,this.setup(e,t)}void 0===l?"console"in window&&window.console.error("Featherlight requires jQuery."):l.fn.jquery.match(/-ajax/)?"console"in window&&window.console.info("Featherlight needs regular jQuery, not the slim version."):(r=[],a.prototype={constructor:a,autoBind:'[data-toggle="featherlight"]',targetAttr:"data-target",openTrigger:"click",filter:null,closeOnClick:"backdrop",closeOnEsc:!0,loading:'<div class="featherlight-loader"></div>',persist:!(o=function(e){var t,n;a._globalHandlerInstalled!==e&&(a._globalHandlerInstalled=e,n=l.map(t={keyup:"onKeyUp",resize:"onResize"},function(e,t){return t+".featherlight"}).join(" "),l(window)[e?"on":"off"](n,function(e){l.each(a.opened().reverse(),function(){if(!e.isDefaultPrevented()&&!1===this[t[e.type]](e))return e.preventDefault(),e.stopPropagation(),!1})}))}),beforeOpen:l.noop,beforeContent:l.noop,beforeClose:l.noop,afterOpen:l.noop,afterContent:l.noop,afterClose:l.noop,onKeyUp:l.noop,onResize:l.noop,type:null,closeIcon:"&#x2716;",contentFilters:["jquery","image","html","ajax","iframe","text"],seamless:!(i=function(t){return r=l.grep(r,function(e){return e!==t&&0<e.$instance.closest("body").length})}),width:"",height:"",maxWidth:"",maxHeight:"",requireWindowWidth:null,setup:function(e,t){"object"!=typeof e||e instanceof l!=!1||t||(t=e,e=void 0);var n=l.extend(this,t,{target:e});return n.$instance=l(['<div class="featherlight featherlight-loading">','  <div class="featherlight-modal'+(n.seamless?" featherlight-seamless":"")+'">','    <div class="featherlight-inner">'+n.loading+"</div>","  </div>","</div>"].join("\n")),n.$instance.on("click.featherlight",function(e){if(!e.isDefaultPrevented())switch(!0){case"backdrop"===n.closeOnClick&&l(e.target).is(".featherlight"):case"anywhere"===n.closeOnClick:case l(e.target).is(".featherlight-close"):n.close(e),e.preventDefault()}}),this},getContent:function(){if(!1!==this.persist&&this.$modal)return this.$modal;var e=this,t=this.constructor.contentFilters,n=e.target||e.$currentTarget&&(e.$currentTarget.attr(name)||e.$currentTarget.attr("href"))||"",r=t[e.type];if(!(r=!r&&n in t?t[n]:r))for(var i in t)e[i]&&(r=t[i],n=e[i]);if(!r){var o=n,n=null;if(l.each(e.contentFilters,function(){return r=t[this],!(n=!(n=r.test?r.test(o):n)&&r.regex&&o.match&&o.match(r.regex)?o:n)}),!n)return"console"in window&&window.console.error("Featherlight: No content filter found "+(o?' for "'+o+'"':" (no target specified)")),!1}return r.process.call(e,n)},setContent:function(e){var t=this;return t.$instance.removeClass("featherlight-loading"),t.$modal=e.show(),t.$instance.find(".featherlight-modal").html(t.$modal),t.closeIcon&&t.$instance.find(".featherlight-modal").prepend(['<div class="featherlight-close-icon featherlight-close">',"  "+t.closeIcon,"</div>"].join("\n")),t},open:function(t){var n=this;if(t&&(t.ctrlKey||t.shiftKey))return!1;if(n.requireWindowWidth&&n.requireWindowWidth>l(window).width())return!1;if(n.$instance.hide().appendTo("body"),!(t&&t.isDefaultPrevented()||!1===n.beforeOpen(t))){t&&t.preventDefault(),l("body").addClass("featherlight-open"),l(".featherlight").removeClass("active"),n.$instance.addClass("active");var e=n.getContent();if(e)return r.push(n),o(!0),n.$instance.show(),n.beforeContent(t),l.when(e).always(function(e){n.setContent(e),n.width&&n.$modal.parent().css("width",n.width),n.height&&n.$modal.parent().css("height",n.height),n.maxWidth&&n.$modal.parent().css("max-width",n.maxWidth),n.maxHeight&&n.$modal.parent().css("max-height",n.maxHeight),n.afterContent(t)}).then(n.$instance.promise()).done(function(){n.afterOpen(t)})}return n.$instance.detach(),l.Deferred().reject().promise()},close:function(e){var t=this,n=l.Deferred();return!1===t.beforeClose(e)?n.reject():(0===i(t).length&&o(!1),t.$instance.hide().detach(),t.afterClose(e),n.resolve(),l(".featherlight:not(.active)").filter(":last").addClass("active"),0===l(".featherlight").length&&l("body").removeClass("featherlight-open")),n.promise()}},l.extend(a,{id:0,defaults:a.prototype,contentFilters:{jquery:{regex:/^[#.]\w/,test:function(e){return e instanceof l&&e},process:function(e){return!1!==this.persist?l(e):l(e).clone(!0)}},image:{regex:/\.(a?png|avif|bmp|gif|ico|jpe?g|jp2|svg|tiff?|webp)(\?\S*)?$/i,process:function(e){var t=l.Deferred();l("<img>",{src:e,alt:"",complete:function(){t.resolve(l(this))}});return t.promise()}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(e){return l(e)}},ajax:{regex:/./,process:function(e){var n=l.Deferred(),r=l("<div></div>").load(e.replace("#"," #"),function(e,t){"error"!==t&&n.resolve(r.contents()),n.reject()});return n.promise()}},iframe:{process:function(e){var t=this,n=new l.Deferred,r=l("<iframe/>",{src:e,complete:function(){r.show().appendTo(t.$instance.find(".featherlight-modal")),n.resolve(r)}}).hide();return n.promise()}},text:{process:function(e){return l("<div>",{text:e})}}},readElementConfig:function(e){var n;if(e)return n=l(e).data(),l.each(["beforeOpen","afterOpen","beforeContent","afterContent","beforeClose","afterClose"],function(e,t){void 0!==n[t]&&(n[t]=new Function(n[t]))}),n},attach:function(i,o,a){function e(e){var t=l(e.currentTarget),n=l.extend({$source:i,$currentTarget:t},c.readElementConfig(i[0]),c.readElementConfig(this),a),r=s||t.data("featherlight-persisted")||new c(o,n);"shared"===r.persist?s=r:!1!==r.persist&&t.data("featherlight-persisted",r),n.$currentTarget.blur&&n.$currentTarget.blur(),r.open(e)}var s,c=this,t=("object"!=typeof o||o instanceof l!=!1||a||(a=o,o=void 0),a=l.extend({},a),l.extend({},c.defaults,c.readElementConfig(i[0]),a));return i.on(t.openTrigger+".featherlight",t.filter,e),{filter:t.filter,handler:e}},current:function(){var e=this.opened();return e[e.length-1]||null},opened:function(){var t=this;return i(),l.grep(r,function(e){return e instanceof t})},close:function(e){var t=this.current();if(t)return t.close(e)},_callbackChain:{onKeyUp:function(e,t){return 27===t.keyCode?(this.closeOnEsc&&l.featherlight.close(t),!1):e(t)},onResize:function(e,t){return e(t)},beforeOpen:function(e,t){return this._previouslyActive=document.activeElement,this._$previouslyTabbable=l("a, input, select, textarea, iframe, button, iframe, [contentEditable=true]").not("[tabindex]").not(this.$instance.find("button")),this._$previouslyWithTabIndex=l("[tabindex]").not('[tabindex="-1"]'),this._previousWithTabIndices=this._$previouslyWithTabIndex.map(function(e,t){return l(t).attr("tabindex")}),this._$previouslyWithTabIndex.add(this._$previouslyTabbable).attr("tabindex",-1),document.activeElement.blur&&document.activeElement.blur(),e(t)},afterContent:function(e,t){return this.$instance.find("[autofocus]:not([disabled])").trigger("focus"),this.onResize(t),e(t)},afterClose:function(e,t){var n=this;return this._$previouslyTabbable.removeAttr("tabindex"),this._$previouslyWithTabIndex.each(function(e,t){l(t).attr("tabindex",n._previousWithTabIndices[e])}),this._previouslyActive.trigger("focus"),this.$instance.off("next.featherlight previous.featherlight"),e(t)}}}),l.featherlight=a,l.fn.featherlight=function(e,t){return a.attach(this,e,t),this},l(document).ready(function(){var r;a.autoBind&&((r=l(a.autoBind)).each(function(){a.attach(l(this))}),l(document).on("click",a.autoBind,function(e){var t,n;e.isDefaultPrevented()||(t=l(e.currentTarget),r.length!==(r=r.add(t)).length&&(!(n=a.attach(t)).filter||0<l(e.target).parentsUntil(t,n.filter).length)&&n.handler(e))}))}))})(jQuery);